<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"
		  name="viewport">
	<meta content="ie=edge" http-equiv="X-UA-Compatible">
	<title>Controlling Element Visibility Using IntersectionObserver</title>
	<style>
		.card-grid {
			display: grid;
			grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
			grid-gap: 45px;
			width: 100%;
			padding: 64px;
		}

		.card {
			height: 100px;
			border-radius: 6px;
			background-color: var(--primary-color);
			box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.15);
			transition: all 0.2s ease-in-out;
		}
	</style>
	<script>
		const cardGrid = document.querySelector(".card-grid");

		for (let i = 0; i < 64; i++) {
			const card = document.createElement("div");
			card.classList.add("card");
			cardGrid.appendChild(card);
		}

		const options = {
			rootMargin: '-100px',
			threshold: [0.5, 1]
		}

		const callback = entries => {
			entries.forEach(entry => {
				const ratio = entry.intersectionRatio;

				switch (true) {
					case (ratio === 1):
						entry.target.style.opacity = 1;
						entry.target.style.transform = 'scale(1.25)';
						return;
					case (ratio < 1 && ratio >= 0.5):
						entry.target.style.opacity = 0.5;
						entry.target.style.transform = 'scale(1.1)';
						return;
					case (ratio < 0.5):
						entry.target.style.opacity = 0.15;
						entry.target.style.transform = 'scale(1.0)';
						return;
					default:
						return;
				}
			});
		}

		const observer = new IntersectionObserver(callback, options);

		const targets = document.querySelectorAll('.card');
		targets.forEach(target => observer.observe(target));
	</script>
</head>
<body>
	<div class="wrap">
		<div class="card-grid"></div>
	</div>
</body>
</html>
